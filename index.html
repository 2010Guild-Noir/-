<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ä¿®ç¾…ç‹ä¸¸ã¨å¾€ãè™šã®ä»®æƒ³å¤œæ—…</title>

<link rel="icon" href="images/favicon.png" type="image/png">
<link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32.png">
<link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16.png">
<link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
<meta name="theme-color" content="#0b1220">
<link rel="icon" href="images/favicon.svg" type="image/svg+xml">
<!-- äº’æ›ç”¨ã«PNGã‚‚ä½µè¨˜ -->
<link rel="icon" href="images/favicon-32.png" sizes="32x32" type="image/png">
<link rel="shortcut icon" href="favicon.ico">


<!-- Open Graph / Facebook / LINE / Slack ãªã© -->
<meta property="og:title" content="ä¿®ç¾…ç‹ä¸¸ã¨å¾€ãè™šã®ä»®æƒ³å¤œæ—…">
<meta property="og:description" content="5ã¤ã®é¸æŠã§é€²ã‚€è™šã‚ã®æ£®ã€‚ã©ã®é“ã«æ­£è§£ã‚‚å¤±æ•—ã‚‚ãªãã€ã‚ãªãŸã®æ­©ã¿ãŒå¤œã‚’ã‹ãŸã¡ä½œã‚‹ã€‚">
<meta property="og:type" content="website">
<meta property="og:url" content="https://2010guild-noir.github.io/-/">
<meta property="og:image" content="https://2010guild-noir.github.io/-/images/og.jpg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">

<!-- Twitterï¼ˆXï¼‰ -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="ä¿®ç¾…ç‹ä¸¸ã¨å¾€ãè™šã®ä»®æƒ³å¤œæ—…">
<meta name="twitter:description" content="5ã¤ã®é¸æŠã§é€²ã‚€è™šã‚ã®æ£®ã€‚ã©ã®é“ã«æ­£è§£ã‚‚å¤±æ•—ã‚‚ãªãã€ã‚ãªãŸã®æ­©ã¿ãŒå¤œã‚’ã‹ãŸã¡ä½œã‚‹ã€‚">
<meta name="twitter:image" content="https://2010guild-noir.github.io/-/images/og.jpg">


<style>
  :root{
    --bg1:#0b1220;  /* å¤œç©ºã®ç¾¤é’ */
    --bg2:#1b2735;  /* æ£®ã®è— */
    --ink:#e9eef6;  /* æ–‡å­—è‰² */
    --mute:#8aa0b5; /* ã‚µãƒ–æ–‡å­— */
    --accent:#89b4fa; /* ã‚¢ã‚¯ã‚»ãƒ³ãƒˆ */
  }
  html,body{
    margin:0; padding:0; height:100%;
    background: radial-gradient(1200px 800px at 50% -10%, var(--bg2), var(--bg1));
    color:var(--ink); font-family: "Shippori Mincho", "æ¸¸æ˜æœ", "Yu Mincho", serif;
}
  .wrap{ max-width:900px; margin:0 auto; padding:24px 16px 56px; text-align:center; }
  h1{ margin:12px 0 6px; font-weight:700; font-size:clamp(20px, 3.6vw, 28px);}
  .sub{ color:var(--mute); margin:0 0 18px; font-size:14px;}
  .scene{
    width:min(92vw,880px); aspect-ratio: 16/9; object-fit: cover;
    border-radius:16px; box-shadow: 0 8px 28px rgba(0,0,0,.35); display:block; margin:8px auto 14px;
  }
  .panel{
    background: rgba(10,16,26,.45); backdrop-filter: blur(6px);
    border: 1px solid rgba(137,180,250,.18);
    border-radius: 16px; padding:18px 16px; margin:0 auto 14px; max-width:880px;
    box-shadow: 0 6px 24px rgba(0,0,0,.25);
    text-align:left;
  }
  .panel p{ margin: 0.4em 0; line-height:1.95; }
  .narr{ white-space:pre-wrap; }
  #micro{ margin: 2px 0 10px; color:#cfdbeb; }
  #text{ font-size:clamp(16px, 2.6vw, 20px); margin:0 0 10px; text-align:center;}
  .choices{ display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin:12px 0 0;}
  button{
    background: transparent; color:var(--ink);
    border:1px solid var(--accent); border-radius:999px;
    padding:10px 18px; font-size:16px; cursor:pointer;
    transition:.15s transform ease, .15s background-color ease, .15s border-color ease;
  }
  button:hover{ transform: translateY(-1px); background: rgba(137,180,250,.08);}
  #story{ margin:16px 0 0; font-weight:600; min-height:2.6em; text-align:center;}
  #imageWrap img{ max-width:min(92vw,880px); height:auto; display:block; margin:14px auto 0; border-radius:14px; box-shadow:0 8px 28px rgba(0,0,0,.35);}
  .hint{ color:#8aa0b5; font-size:13px; margin-top:10px; text-align:center; }
  hr{ border:0; height:1px; background: linear-gradient(90deg,transparent, rgba(137,180,250,.35), transparent); margin:26px 0; }

  /* é€²æ—UI */
  .key{
    display:inline-block; margin:2px 4px; padding:2px 6px;
    border:1px solid rgba(137,180,250,.35); border-radius:8px;
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size:12px; color:#cfe1ff;
  }
  .bar{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; letter-spacing:1px; }

  /* BGM */
  .audioBar{ display:flex; align-items:center; justify-content:center; gap:10px; margin:10px auto 6px; opacity:.9; }
  .audioBar button{ border-radius:10px; padding:8px 12px; font-size:14px; }
  .audioBar input[type="range"]{ width:180px; }
  .badge{ display:inline-block; font-size:12px; color:#cfe1ff; border:1px dashed rgba(207,225,255,.5); padding:2px 8px; border-radius:8px; }
  .footnote{ color:var(--mute); font-size:12px; margin-top:8px; text-align:center;}
</style>
</head>
<body>
<div class="wrap">
  <h1>ä¿®ç¾…ç‹ä¸¸ã¨å¾€ãè™šã®ä»®æƒ³å¤œæ—…</h1>
  <p class="sub">5ã¤ã®é¸æŠãŒè™šã‚ã®æ£®ã«é“ã‚’å¼•ãã€‚ã©ã®é“ã«æ­£è§£ã‚‚å¤±æ•—ã‚‚ãªãã€ãŸã èª°ã®ã‚‚ã®ã¨ã‚‚é•ã†ã€ã‚ãªãŸè‡ªèº«ã®æ—…ã¨ãªã‚‹ã€‚</p>

  <!-- å›ºå®šã®é¸æŠç”»é¢ç”»åƒï¼ˆä»»æ„ï¼‰ã€‚ç„¡ã‘ã‚Œã°è‡ªå‹•ã§éè¡¨ç¤ºã€‚ -->
  <img id="scene" class="scene" src="images/scene_select.webp" alt="å¤œã®æ£®" />

  <!-- ã‚·ãƒ§ãƒ¼ãƒˆã‚¹ãƒˆãƒ¼ãƒªãƒ¼ï¼ˆå†’é ­ï¼‰ -->
 <div id="intro" class="panel">
  <p class="narr">ã—ã‚“ã—ã‚“ã¨ã€éŸ³ã‚‚ãªãå¤œãŒé™ã‚‹ã€‚</p>
  <p class="narr">ã‚ãªãŸã¯å¯åºŠã«èº«ã‚’ä¼¸ã°ã—ã€ãŸã ç›®ã‚’é–‰ã˜ã¦ã„ãŸã€‚</p>
  <p class="narr">ãã®ç„¡éŸ³ã«ã€ã²ã¨ã™ã˜ã®å£°ãŒå·®ã—è¾¼ã‚€ã€‚</p>
  <p class="narr">ã€Œå…¶æ–¹ã€è™šã‚ã®å¤œã‚’æ¸¡ã‚‹æ°—ã‹ã€</p>
  <p class="narr">é—‡ã‚’çºã£ãŸä¿®ç¾…ç‹ä¸¸ãŒ èµ¤ã„ç³ã§ã“ã¡ã‚‰ã‚’è¦‹ã¤ã‚ã¦ã„ã‚‹ã€‚</p>
  <p class="narr">æ°—ã¥ã‘ã°ã€ã‚ãªãŸã¯é»’ã„æ£®ã®ç¸ã«ç«‹ã£ã¦ã„ãŸã€‚</p>
  <p class="narr">ã€Œãªã‚‰ã°ã€ä½™ãŒå°ã“ã†ã€‚ãŸã ã—ã“ã‚Œã¯å¤¢ã§ã¯ãªã„ã€‚ä»®æƒ³ã«ã—ã¦ã€çœŸã®æ—…ã‚ˆã€</p>
</div>

  <!-- é¸æŠãƒ‘ãƒãƒ« -->
  <div class="panel">
    <p id="micro" class="narr"></p>
    <p id="text" style="text-align:center;">å¤œã®æ£®ã§ã€ä¿®ç¾…ç‹ä¸¸ãŒæ‰‹æ‹›ãã€‚ããªãŸã¯æ­©ã‚’åˆã‚ã›ã‚‹ï¼Ÿ</p>
    <div id="choices" class="choices" style="text-align:center;">
      <button onclick="choose(1)">æ­©ã‚’åˆã‚ã›ã‚‹</button>
      <button onclick="choose(2)">è·é›¢ã‚’å–ã‚‹</button>
    </div>
    <p id="story"></p>
  </div>

  <div id="imageWrap"></div>
  <div id="endControls" style="text-align:center; margin-top:10px;"></div>

  <p class="hint" id="hint"></p>
  <p class="hint" id="progress"></p>
  <details id="comp" class="hint" style="margin-top:6px;">
    <summary>æœªé”ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ä¸€è¦§ã‚’é–‹ã</summary>
    <div id="unseen" class="hint" style="margin-top:8px;"></div>
  </details>


  <!-- ===== BGMï¼ˆãƒšãƒ¼ã‚¸æœ€ä¸‹éƒ¨ï¼‰ ===== -->
  <div class="panel" style="text-align:center; margin-top:24px;">
    <p class="narr" style="text-align:center; color:#cfdbeb; margin-bottom:10px;">å¤œæ­©ãã®æ”¯åº¦ï¼šéŸ³ãŒé‚ªé­”ãªã‚‰ãƒŸãƒ¥ãƒ¼ãƒˆã‚’ã€‚å°ã•ãæµã™ã®ã‚‚ä¸€èˆˆã ã€‚</p>
    <audio id="bgm" src="audio/bgm_night_forest.mp3" loop preload="auto"></audio>
    <div class="audioBar">
      <span class="badge">BGM</span>
      <button id="playBtn" onclick="togglePlay()">â–¶ å†ç”Ÿ</button>
      <button onclick="bgm.muted = !bgm.muted; this.textContent = bgm.muted ? 'ğŸ”‡ ãƒŸãƒ¥ãƒ¼ãƒˆè§£é™¤' : 'ğŸ”Š ãƒŸãƒ¥ãƒ¼ãƒˆ';">ğŸ”Š ãƒŸãƒ¥ãƒ¼ãƒˆ</button>
      <label>éŸ³é‡ <input id="vol" type="range" min="0" max="1" step="0.01" value="0.35" oninput="bgm.volume=this.value"></label>
    </div>
    <p class="footnote">â€» è‡ªå‹•å†ç”Ÿåˆ¶é™ã«ã‚ˆã‚Šã€æœ€åˆã®ã‚¯ãƒªãƒƒã‚¯ã¾ã§éŸ³ã¯é³´ã‚Šã¾ã›ã‚“ã€‚</p>
  </div>
</div>

<script>
  /* ===== åŸºæœ¬è¨­å®š ===== */
  const DEPTH = 5;            // 5æ®µéš = 32ã‚¨ãƒ³ãƒ‰
  let step = 0;               // ç¾åœ¨æ®µéšï¼ˆ0ã‚¹ã‚¿ãƒ¼ãƒˆï¼‰
  let path = [];              // é¸æŠã®è¨˜éŒ² [1,2,1,2,1]
  const introEl  = document.getElementById("intro");
  const microEl  = document.getElementById("micro");
  const textEl   = document.getElementById("text");
  const storyEl  = document.getElementById("story");
  const choicesEl= document.getElementById("choices");
  const hintEl   = document.getElementById("hint");
  const imageWrap= document.getElementById("imageWrap");
  const sceneImg = document.getElementById("scene");
  sceneImg.onerror = ()=>{ sceneImg.style.display = "none"; };

  // BGM
  const bgm = document.getElementById("bgm");
  const playBtn = document.getElementById("playBtn");
  bgm.volume = 0.35;
  let audioArmed = false;
  function armAudio(){ if(!audioArmed){ audioArmed = true; bgm.play().catch(()=>{}); updatePlayBtn(); } }
  function togglePlay(){ if(bgm.paused){ bgm.play().catch(()=>{}); } else { bgm.pause(); } updatePlayBtn(); }
  function updatePlayBtn(){ playBtn.textContent = bgm.paused ? "â–¶ å†ç”Ÿ" : "â¸ ä¸€æ™‚åœæ­¢"; }
  document.addEventListener("click", armAudio, { once:true });
  bgm.addEventListener("play", updatePlayBtn);
  bgm.addEventListener("pause", updatePlayBtn);

  /* ===== å„æ®µã‚·ãƒ§ãƒ¼ãƒˆã‚¹ãƒˆãƒ¼ãƒªãƒ¼ ===== */
  function getNarr(step, prefix){
    const N = {
      2: {
        "A":
`è½è‘‰ã¯è¸ã‚ã°é³´ã‚‹ãŒã€æ£®ã¯ãã‚Œã‚’è²¬ã‚ãšã€‚é³´ã£ãŸéŸ³ã®æ•°ã ã‘ã€ã‚ãªãŸã®è¿·ã„ãŒæŠœã‘ã‚‹ã€‚
ã€Œæ­©å¹…ã¯åˆã‚ã™ãªã€å‘¼å¸ã‚’åˆã‚ã™ã®ã ã€‚ç„¦ã‚Šã¯è¶³éŸ³ã‚’è’ã‚‰ã™â€•â€•é™ã‹ã«è¡Œã‘ã€`,
        "B":
`è·é›¢ã‚’å–ã‚Œã°è¦–ç•Œã¯åºƒãŒã‚‹ã€‚ã ãŒåºƒã•ã¯è²¬ä»»ã§ã‚‚ã‚ã‚‹ã€‚é ããªã‚‹ã»ã©ã€å·±ã®è¶³è·¡ã¯è–„ããªã‚‹ã€‚
ã€Œé›¢ã‚Œã‚‹ã®ã¯è‰¯ã„ã€‚ã ãŒé ã™ãã‚Œã°ã€é“ãã®ã‚‚ã®ã‚’è¦‹å¤±ã†ã€‚åˆ»ã‚ã€å…¶æ–¹ã®æ­©å¹…ã‚’ã€`
      },
      3: {
        "AA":
`ç«‹æœ¨ã®é–“ã«æ²ˆã‚€æœ½ã¡ãŸç¥ ã®ä¸­ã«ç¯ã®å½±ãŒæºã‚Œã¦ã„ã‚‹ã€‚ç¥ ã¨ã¯å¤ã„å•ã„ã‚’æŠ±ãˆã‚‹å™¨ã€‚
ã€Œæ‰‰ã¯å£ã§ã¯ãªã„ã€‚å©ã‘ã©ã‚‚è¿”äº‹ã¯ã›ã¬ã€‚é–‹ã‘ã°æ²ˆé»™ã§å¿œã˜ã‚‹â€•â€•é¸ã¹ã€`,
        "AB":
`éœ²ã¯ã²ã¨ã¤ã®æ˜Ÿã‚’äºŒã¤ã«ã‚‚ä¸‰ã¤ã«ã‚‚å‰²ã£ã¦ã¿ã›ã‚‹ã€‚æ‰‹ãŒè§¦ã‚Œã‚Œã°ã€æ˜Ÿã¯éŸ³ã«ãªã‚‹ã ã‘ã ã€‚
ã€Œé³´ã‚‰ã™ã‚‚ã‚ˆã—ã€é³´ã‚‰ã•ã¬ã‚‚ã‚ˆã—ã€‚ã©ã¡ã‚‰ã‚‚é™ã‘ã•ã®å½¢â€•â€•è‡†ã›ãšé¸ã¹ã€`,
        "BA":
`æ°´é¢ã¯å˜˜ã‚’ã¤ã‹ã¬ã€‚æ¸¡ã‚‹è€…ã®é‡ã¿ã ã‘ã€æ³¢ç´‹ã¯æ­£ã—ãæ­ªã‚€ã€‚æ¿¡ã‚ŒãŸè·¡ã¯ã€æ­£ç›´ã ã€‚
ã€Œæ¸¡ã‚‹ã¯å®£è¨€ã€æ¸¡ã‚‰ã¬ã¯ä¿ç•™ã€‚ã©ã¡ã‚‰ã‚‚ç”Ÿã®è¡“â€•â€•å…¶æ–¹ã¯ã©ã¡ã‚‰ã‚’é¸ã¶ï¼Ÿã€`,
        "BB":
`åˆ†ã‹ã‚Œé“ã¨ã¯èª°ã®ãŸã‚ã«ã‚‚ç”¨æ„ã•ã‚Œã¦ã„ãªã„ã€‚ç«‹ã¡æ­¢ã¾ã‚‹è€…ã®ãŸã‚ã«ã ã‘ã€é•·ãæ˜ ãˆã‚‹ã€‚
ã€Œåœ°å›³ã¯ãªã„ã€‚ã‚ã‚‹ã®ã¯è¶³ã®é›éŒ¬ã ã‘ã ã€‚é€²ã‚ã€å…¶æ–¹ã®å¸«ã§ã‚ã‚Œã€`
      },
      4: {
        "AAA":
`å¥¥ã®ç¯ã¯ã€å‘¼å¸ã®ã‚ˆã†ã«ç´°ã‚‹ã€‚ã¨ã‚‚ã›ã°è¿‘ã¥ãã€æ¶ˆã›ã°é ã–ã‹ã‚‹ã€‚è·é›¢ã®è¨“ç·´ã ã€‚
ã€Œç¯ã‚’æ‰±ãˆã€‚ç¯ã«æ‰±ã‚ã‚Œã‚‹ãªã€‚å…¶æ–¹ã®æ„ã§æ˜æ»…ã•ã›ã‚ˆã€`,
        "AAB":
`åã¯åˆƒã§ã‚ã‚ŠèˆŸã§ã‚‚ã‚ã‚‹ã€‚å‘¼ã¹ã°å±ŠããŒã€å±ŠããŸã³ã«é˜ã«å¸°ã‚ŠãŸãŒã‚‹ã€‚
ã€ŒäºŒåº¦ç›®ã®å‘¼ã³å£°ã¯ã€æƒ…ã§ã¯ãªãæŠ€ã§ã‚ã‚Œã€`,
        "ABA":
`æ‰‹ã¯é–ã§ã¯ãªã„ã€‚çµã¹ã°æ¸©ã‹ã„ãŒã€ãã¤ãçµã¹ã°ç—›ã¿ã‚‚èµ°ã‚‹ã€‚é›¢ã›ã°è‡ªç”±ã ãŒã€å†·ãˆã‚‚ã™ã‚‹ã€‚
ã€Œæ¡ã‚‹ã‚‚é›¢ã™ã‚‚çœ‹å–ã‚Šã ã€‚ã©ã¡ã‚‰ã®çœ‹å–ã‚Šã‚’é¸ã¶ã€`,
        "ABB":
`èƒŒã®æ¸©åº¦ã¯å¿˜å´ã®äºˆç¿’ã ã€‚ä»Šã€ç¢ºã‹ã«åœ¨ã‚‹ã‚‚ã®ã»ã©ã€å…ˆã«è–„ããªã‚‹ã€‚
ã€ŒæŒ¯ã‚Šè¿”ã‚‹ã¯å›åã€ãã®ã¾ã¾ã¯è­²æ¸¡ã€‚ã©ã¡ã‚‰ã‚‚åˆ¥ã‚Œã®ç¤¼æ³•ã ã€`,
        "BAA":
`æµ…ç€¬ã§æœˆã¯å‰²ã‚Œã¦å¢—ãˆã‚‹ã€‚æ•°ãŒå¢—ãˆãŸã¨ã“ã‚ã§ã€æº€ã¡ã‚‹ã‚ã‘ã§ã¯ãªã„ã€‚
ã€Œå°ã‚’æ®‹ã™è¶³ã‹ã€çŸ³ã‚’é¸ã¶ç›®ã‹ã€‚å…¶æ–¹ã¯ã©ã¡ã‚‰ã‚’é›ãˆã‚‹ã€`,
        "BAB":
`æ©‹ã¯ç„¡ã„ãŒã€å£°ã¯æ¸¡ã‚‹ã€‚æ¸¡ã£ãŸå£°ã¯æˆ»ã‚‰ãªã„ã€‚æˆ»ã‚‰ã¬å£°ã ã‘ãŒé“ã‚’ä½œã‚‹ã€‚
ã€Œã‹ã‘ã‚‹è¨€è‘‰ã¯çŸ­ãã¦ã‚ˆã„ã€‚é•·ã•ã¯å¼·ã•ã®ä¿è¨¼ã§ã¯ãªã„ã€`,
        "BBA":
`æ¹¿ã‚Šã¯é…ãã€ä¹¾ãã¯é€Ÿã„ã€‚é…ã•ã¯æ€è€ƒã‚’å‘¼ã³ã€é€Ÿã•ã¯æ±ºæ–­ã‚’å‘¼ã¶ã€‚
ã€Œæ—…ã¯äºŒæ‹å­ã ã€‚é…æ»ã‚‚æ€§ã€è¿…é€Ÿã‚‚æ€§ã€‚ä»Šã¯ã©ã¡ã‚‰ãŒæ­£ã ã€`,
        "BBB":
`è¡Œãæ­¢ã¾ã‚Šã¯å£ã§ã¯ãªã„ã€‚ç›®ãŒãã†å‘¼ã¶ã ã‘ã ã€‚è©¦ã¿ã«åã‚’å¤‰ãˆã‚ˆã€é“ã¨ã€‚
ã€Œå‘¼ã³åã¯åŠ›ã ã€‚ããªãŸãŒå£ã‚’é“ã¨å‘¼ã¹ã°ã€ä¸€æ­©ã¯å‰ã«å‡ºã‚‹ã€`
      }
    };

    // 2ã€œ4æ®µç›®ï¼šæœ€é•·ä¸€è‡´ã§è¿”ã™
    const m = N[step];
    if (m){
      let key = prefix || "";
      while(key.length >= 0){
        if(m[key]) return m[key];
        key = key.slice(0,-1);
        if(key.length===0) break;
      }
    }

    // 5æ®µç›®ï¼šä¿®ç¾…ç‹ä¸¸ã®ä¸€è¨€ï¼ˆæœ€çµ‚ã®å‰å£ä¸Šï¼‰
    if (step === 5){
      const last2 = (prefix || "").slice(-2); // "AA","AB","BA","BB"
      const narrMap = {
        "AA": "ã€Œã“ã“ãŒã“ã®åœ°ã®æœã¦ã€‚è¿‘ã•ã¯åˆƒã«ã‚‚ç›¾ã«ã‚‚ãªã‚‹ã€‚æœ€çµ‚ã®ä¸€æ‰‹ã€æ…é‡ã«é¸ã¶ãŒã‚ˆã„ã€",
        "AB": "ã€Œå¤¢ã¨ç¾ã®é–“åˆã„ã¯å‡ªã„ã ã€‚å´©ã™ã‚‚å®ˆã‚‹ã‚‚ã€ã“ã“ã§æ±ºã‚ã‚ˆã€",
        "BA": "ã€Œé£²ã¿è¾¼ã‚€é—‡ã¯è¿«ã‚Šã€é“ã¯ç—©ã›ã‚‹ã€‚æ¸¡ã‚‹ã‹ç•™ã¾ã‚‹ã‹ã€ã©ã¡ã‚‰ã‚‚æ­£ã ã€‚å·±ã®é€Ÿã•ã§è¡Œã‘ã€",
        "BB": "ã€Œé¢¨ãŒé–‹ã‘ã‚‹ã€‚ä»°ãç©ºã¨è¸ã‚€åœ°ã€å…¶æ–¹ã¯ã©ã¡ã‚‰ã‚’è¦‹ã‚‹ã€"
      };
      return narrMap[last2] || "ã€Œæ£®ã¯é™ã‹ã«æ¯ã‚’æ½œã‚ã¦ã„ã‚‹ã€‚å…¶æ–¹ã®ä¸€æ‰‹ã§ã€æ—…ã‚’ç· ã‚ã‚ˆã€";
    }

    return "";
  }

  /* ===== ä¸­é–“ãƒãƒ¼ãƒ‰ï¼ˆå•ã„ã¨ãƒœã‚¿ãƒ³æ–‡ï¼‰ ===== */
  function getNode(step, prefix){
    const T = {
      1: { "": { q:"å¤œã®æ£®ã§ã€ä¿®ç¾…ç‹ä¸¸ãŒæ‰‹æ‹›ãã€‚ã‚ãªãŸã¯æ­©ã‚’åˆã‚ã›ã‚‹ï¼Ÿ",
                 a:"æ­©ã‚’åˆã‚ã›ã‚‹", b:"è·é›¢ã‚’å–ã‚‹" } },
      2: {
        "A": { q:"æœˆãŒç´°ã‚Šã€å½±ãŒé‡ãªã‚‹ã€‚ã‚ãªãŸã¯æ¬¡ã«ã©ã†ã™ã‚‹ï¼Ÿ",
               a:"å½¼ã®åã‚’å‘¼ã¶", b:"æ²ˆé»™ã§å¿œãˆã‚‹" },
        "B": { q:"å½±ã¯äºŒã¤ã€æè‘‰ã«æºã‚Œã¦é ã„ã€‚ã‚ãªãŸã¯æ¬¡ã«ã©ã†ã™ã‚‹ï¼Ÿ",
               a:"è¿½ã„ã¤ã", b:"ã•ã‚‰ã«é›¢ã‚Œã‚‹" }
      },
      3: {
        "AA":{ q:"ç¥ ã®å‰ã§ç«‹ã¡ã™ãã‚€ã€‚ã‚ãªãŸã¯ã©ã†é¸ã¶ï¼Ÿ",
               a:"æ‰‰ã‚’æŠ¼ã—é–‹ã‘ã‚‹", b:"æ‰‰ã«æ‰‹ã‚’ç½®ãã ã‘" },
        "AB":{ q:"éœ²ã®è‰ã‚€ã‚‰ã§ã€é¢¨éˆ´ã®ã‚ˆã†ãªéŸ³ã€‚ã‚ãªãŸã¯ã©ã†é¸ã¶ï¼Ÿ",
               a:"æ‰‹ã‚’ä¼¸ã°ã™", b:"æ‰‹ã‚’å¼•ã" },
        "BA":{ q:"å°å·ã®ãã‚‰ã‚ããŒé“ã‚’æ¨ªåˆ‡ã‚‹ã€‚ã‚ãªãŸã¯ã©ã†é¸ã¶ï¼Ÿ",
               a:"æ¸¡ã‚‹", b:"æ¸¡ã‚‰ãªã„" },
        "BB":{ q:"ç£é“ãŒäºŒè‚¡ã«å‰²ã‚Œã¦ã„ãŸã€‚ã‚ãªãŸã¯ã©ã†é¸ã¶ï¼Ÿ",
               a:"å·¦ã¸é€²ã‚€", b:"å³ã¸é€²ã‚€" }
      },
      4: {
        "AAA":{ q:"ç¥ ã®å¥¥ã€ç¯ãŒã²ã¨ã¤éœ‡ãˆã‚‹ã€‚ã‚ãªãŸã¯ï¼Ÿ",
                a:"ç¯ã‚’ã¨ã‚‚ã™", b:"ç¯ã‚’æ¶ˆã™" },
        "AAB":{ q:"æ²ˆé»™ã®åº•ã§ã€åãŒã‹ã™ã‹ã«è„ˆæ‰“ã¤ã€‚ã‚ãªãŸã¯ï¼Ÿ",
                a:"åã‚’ã‚‚ã†ä¸€åº¦å‘¼ã¶", b:"å‘¼ã¶ã®ã‚’ã‚„ã‚ã‚‹" },
        "ABA":{ q:"æŒ‡å…ˆã®å†·ãŸã•ãŒç¾ã¸å¼•ãæˆ»ã™ã€‚ã‚ãªãŸã¯ï¼Ÿ",
                a:"æ‰‹ã‚’æ¡ã‚‹", b:"æ‰‹ã‚’é›¢ã™" },
        "ABB":{ q:"èƒŒã®æ¸©åº¦ãŒè–„ã‚Œã¦ã„ãã€‚ã‚ãªãŸã¯ï¼Ÿ",
                a:"æŒ¯ã‚Šè¿”ã‚‹", b:"ãã®ã¾ã¾æ­©ã" },
        "BAA":{ q:"æµ…ç€¬ã®æºã‚‰ã‚ãã«æ°´é¢ã®æœˆãŒå‰²ã‚Œã‚‹ã€‚ã‚ãªãŸã¯ï¼Ÿ",
                a:"è¶³ã‚’æ¿¡ã‚‰ã™", b:"çŸ³ã‚’é¸ã¶" },
        "BAB":{ q:"æ©‹ã¯ç„¡ã„ãŒã€éŸ³ã ã‘ãŒæ¸¡ã£ã¦ã‚†ãã€‚ã‚ãªãŸã¯ï¼Ÿ",
                a:"å£°ã‚’ã‹ã‘ã‚‹", b:"é»™ã£ã¦ã†ãªãšã" },
        "BBA":{ q:"å·¦ã®é“ã¯æ¹¿ã‚Šã€å³ã®é“ã¯ä¹¾ãã€‚ã‚ãªãŸã¯ï¼Ÿ",
                a:"æ¹¿ã‚Šã¸", b:"ä¹¾ãã¸" },
        "BBB":{ q:"å²¸å£ã¨å·ã€ã©ã¡ã‚‰ã‚‚è¡Œãæ­¢ã¾ã‚Šã«è¦‹ãˆã‚‹ã€‚ã‚ãªãŸã¯ï¼Ÿ",
                a:"ä¸Šç©ºã‚’ä»°ã", b:"åœ°é¢ã‚’è¦‹ã‚‹" }
      }
    };

    // 1ã€œ4æ®µç›®ï¼šæœ€é•·ä¸€è‡´
    if (step >= 1 && step <= 4) {
      const s = T[step]; if (!s) return { q:"æ£®ã¯é™ã‹ã«ã‚ãªãŸã‚’å¾…ã¤ã€‚ã©ã†ã™ã‚‹ï¼Ÿ", a:"é€²ã‚€", b:"ç•™ã¾ã‚‹" };
      let key = prefix || "";
      while (key.length >= 0) {
        if (s[key]) return s[key];
        key = key.slice(0, -1);
        if (key.length === 0 && s[""]) return s[""];
        if (key.length === 0) break;
      }
      return { q:"æ£®ã¯é™ã‹ã«ã‚ãªãŸã‚’å¾…ã¤ã€‚ã©ã†ã™ã‚‹ï¼Ÿ", a:"é€²ã‚€", b:"ç•™ã¾ã‚‹" };
    }

    // 5æ®µç›®ã¯å‹•çš„ã«ç”Ÿæˆï¼ˆprefix ã¯4æ–‡å­—ï¼ç›´å‰ã¾ã§ã®çµŒè·¯ï¼‰
    if (step === 5) {
      const last2 = (prefix || "").slice(-2); // "AA","AB","BA","BB"
      const map = {
        "AA": { q:"æœ€å¥¥ã€‚ç¯ã¨å½±ãŒå¯„ã‚Šæ·»ã†ã€‚ã‚ãªãŸã®æœ€å¾Œã®é¸æŠã¯ï¼Ÿ",
                a:"ãã°ã«å¯„ã‚‹", b:"èº«ã‚’é€€ã" },
        "AB": { q:"æœã¨å¤œã®é™ã‹ãªé–“åˆã„ãŒå‡ªãã€‚ã‚ãªãŸã®æœ€å¾Œã®é¸æŠã¯ï¼Ÿ",
                a:"æšã‚’ç›®æŒ‡ã™", b:"æ£®ã¸å¼•ãè¿”ã™" },
        "BA": { q:"æœ€å¥¥ã€‚å·éŸ³ãŒç´°ã‚Šé“ãŒç—©ã›ã‚‹ã€‚ã‚ãªãŸã®æœ€å¾Œã®é¸æŠã¯ï¼Ÿ",
                a:"æ¸¡ã‚Šãã‚‹", b:"å²¸ã«ç•™ã¾ã‚‹" },
        "BB": { q:"æœ€å¥¥ã€‚é¢¨ãŒé–‹ã‘ã‚‹ã€‚ã‚ãªãŸã®æœ€å¾Œã®é¸æŠã¯ï¼Ÿ",
                a:"ç©ºã‚’ä»°ã", b:"åœ°ã‚’è¸ã¿ã—ã‚ã‚‹" }
      };
      return map[last2] || { q:"æœ€å¥¥ã€‚æ£®ã¯æ¯ã‚’æ½œã‚ã‚‹ã€‚ã‚ãªãŸã¯ï¼Ÿ", a:"é€²ã¿å‡ºã‚‹", b:"ç«‹ã¡æ­¢ã¾ã‚‹" };
    }

    return { q:"æ£®ã¯é™ã‹ã«ã‚ãªãŸã‚’å¾…ã¤ã€‚ã©ã†ã™ã‚‹ï¼Ÿ", a:"é€²ã‚€", b:"ç•™ã¾ã‚‹" };
  }

  /* ===== ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°æ–‡ç”Ÿæˆï¼ˆå¿…ãšåˆ¥ã‚Œã®ä¸€è¨€ã‚’å«ã‚€ï¼‰ ===== */
  function composeEnding(key){
    const Acount = [...key].filter(c=>c==="A").length;
    const nearRatio = Acount / 5;
    const last = key[key.length-1];

    const motifsNear = [
      "æœˆæ˜ã‹ã‚ŠãŒäºŒã¤ã®å½±ã‚’ãã£ã¨é‡ã­ã€",
      "ç¥ ã®ç¯ãŒæµ…ãæ˜æ»…ã—ã€",
      "æŒ‡å…ˆã®æ¸©åº¦ãŒåã®è¼ªéƒ­ã‚’ãŸãã‚Šã€",
      "æµ…ã„æ³¢ç´‹ãŒè¶³é¦–ã®è¨˜æ†¶ã‚’æ’«ã§ã€",
      "å›ããŒè¨€è‘‰ã«ãªã‚‹å‰ã«ã€èƒ¸ã®å¥¥ã§ã»ã©ã‘ã€"
    ];
    const motifsFar = [
      "æè‘‰ãŒå¤œé¢¨ã«æ–‡å­—ã‚’æ•£ã‚‰ã—ã€",
      "é é›·ã®ã‚ˆã†ãªæ²ˆé»™ãŒåœ°ã‚’æº€ãŸã—ã€",
      "éœ²ãŒæ˜Ÿã®æ®‹éŸ¿ã‚’æ‹¾ã„ã€",
      "ç£é“ãŒå¤ã„å¤¢ã®éª¨ã‚’è¦—ã‹ã›ã€",
      "é´è£ã®å½±ã ã‘ãŒæ—…ã®è¨˜éŒ²ã¨ãªã‚Šã€"
    ];
    const hingeLastA = [
      "æœ€å¾Œã®ä¸€æ­©ã¯ããªãŸãŒå…ˆã«è¸ã¿ã€",
      "å…¶æ–¹ãŒç¯ã‚’ã¨ã‚‚ã—ã€",
      "å…¶æ–¹ãŒåã‚’å‘¼ã³ã€",
      "å…¶æ–¹ãŒæ‰‹ã‚’ä¼¸ã°ã—ã€",
      "å…¶æ–¹ãŒå¢ƒã‚’è¶Šãˆã¦ã€"
    ];
    const hingeLastB = [
      "æœ€å¾Œã®ä¸€æ­©ã¯ä½™ãŒå…ˆã«è¸ã¿ã€",
      "å…¶æ–¹ã¯ç¯ã‚’é™ã‹ã«é–‰ã˜ã€",
      "å…¶æ–¹ã¯åã‚’é£²ã¿è¾¼ã¿ã€",
      "å…¶æ–¹ã¯æ‰‹ã‚’ã»ã©ãã€",
      "å…¶æ–¹ã¯å¢ƒã®æ‰‹å‰ã§ã€"
    ];
    // Aå¯„ã‚Šï¼šå¬‰ã—ãã‚‚æ‚²ã—ã’ã«è·é›¢ã‚’ç½®ãï¼ˆå¿…ãšåˆ¥ã‚Œã‚’æ˜è¨€ï¼‰
    const farewellsAheavy = [
      "å°Šãæ­©ã¿ã‚’é€²ã‚“ã§ããŸã€‚",
      "ãã‚Œã§ã‚‚é“ã¯åˆ†ã‘ã­ã°ãªã‚‰ã¬ã€‚", 
      "ãŸã å¾®ç¬‘ã‚’è¿”ã™ã®ã¿ã ã€‚",
      "ãªã‚Œã°å¾€ãå…ˆã¯æ±ºã¾ã£ã¦ã„ã‚‹ã€‚",
      "å…¶æ–¹ã¯æšã¸ã€ä½™ã¯å¤œã¸ã€‚" 
];
 const farewellsBheavy = [ 
"ä½™ã¯èƒŒã‹ã‚‰é¢¨ã‚’é€ã‚ã†ã€‚",
 "è¶…ãˆã¦ããŸå…¶æ–¹ã¯å¤§ä¸ˆå¤«ã ã€‚ç¯ã¯æ®‹ã—ã¦ãŠãã€‚",
 "ã“ã®æ—…ã®ç¶šãã‚’è´ˆã‚‹ã€‚æŒ¯ã‚Šè¿”ã‚‰ãšè¡Œã‘ã€‚",
 "é“ã¯äºŒã¤ã«åˆ†ã‹ã‚ŒãŸã€‚å…¶æ–¹ã¯æœã¸ã€ä½™ã¯å¤œã¸ã€‚",
 "ã“ã“ã¾ã§å…±ã«æ­©ã„ãŸã€‚"
 ];

    function pick(arrN, arrF){ const useNear = Math.random() < nearRatio; const pool = useNear ? arrN : arrF; return pool[Math.floor(Math.random()*pool.length)]; }

    const line1 = pick(motifsNear, motifsFar);
    const line2 = pick(motifsNear, motifsFar);
    const hinge = (last === "A")
      ? hingeLastA[Math.floor(Math.random()*hingeLastA.length)]
      : hingeLastB[Math.floor(Math.random()*hingeLastB.length)];
    const farewell = (nearRatio >= 0.5)
      ? farewellsAheavy[Math.floor(Math.random()*farewellsAheavy.length)]
      : farewellsBheavy[Math.floor(Math.random()*farewellsBheavy.length)];

    return `${line1}${line2}${hinge}${farewell}`;
  }

  /* ===== é€²è¡Œãƒ­ã‚¸ãƒƒã‚¯ ===== */
  function pathToKey(arr){ return arr.map(n => n===1 ? "A" : "B").join(""); }

  function renderNext(){
    const prefix   = pathToKey(path);
    const nextStep = step + 1;

    // 2æ®µç›®ä»¥é™ã®å‰å£ä¸Šï¼ˆ5æ®µç›®ã‚‚å«ã‚€ï¼‰
    microEl.innerText = (nextStep >= 2) ? getNarr(nextStep, prefix) : "";

    const node = getNode(nextStep, prefix);

    textEl.innerText = node.q;
    storyEl.innerText = "";
    imageWrap.innerHTML = "";
    hintEl.innerText = `é¸æŠ ${step}/${DEPTH}ï¼ˆçµŒè·¯: ${prefix || "â€”"}ï¼‰`;

    choicesEl.innerHTML =
      `<button onclick="choose(1)">${escapeHtml(node.a)}</button>` +
      `<button onclick="choose(2)">${escapeHtml(node.b)}</button>`;
  }

  function choose(option){
    armAudio();
    if(step === 0 && introEl) introEl.style.display = "none";

    path.push(option);
    step++;

    if(step < DEPTH){
      renderNext();
      return;
    }

    // ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°
    const key = pathToKey(path);
    const text = composeEnding(key);

    // é”æˆç‡ï¼šè¨˜éŒ²ï¼†æ›´æ–°
    window.__shuraVisited.add(key);
    if(window.__saveVisited) window.__saveVisited();
    if(window.__updateProgress) window.__updateProgress();
    if(window.__renderUnseen) window.__renderUnseen();

    microEl.innerText = "";
    textEl.innerText = "ã€æ—…ã®çµæœ«ã€‘ï¼ˆ" + key + "ï¼‰";
    storyEl.innerText = text;

    // ãƒ‘ãƒãƒ«å†…ã¯ç©ºã«ã—ã€ç”»åƒã®ä¸‹ã«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’å‡ºã™
    hintEl.innerText ="";
    choicesEl.innerHTML = "";

    renderEndingImage(key);
    const endControls = document.getElementById("endControls");
    endControls.innerHTML =
      '<button onclick="restart()">æœ€åˆã‹ã‚‰</button>' +
      '<p class="hint" style="margin-top:8px;">ã‚‚ã†ä¸€åº¦éŠã¶ã«ã¯ã€Œæœ€åˆã‹ã‚‰ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</p>';

    sceneImg.style.display = "none";
  }

  function renderEndingImage(key){
    const imgPath = "images/ending_" + key + ".webp";
    const img = new Image();
    img.alt = "Ending " + key;
    img.onload = ()=>{ imageWrap.innerHTML=""; imageWrap.appendChild(img); };
    img.onerror = ()=>{ imageWrap.innerHTML=""; };
    img.src = imgPath;
  }

  function restart(){
    step = 0; path = [];
    if(introEl) introEl.style.display = "";
    microEl.innerText = "";
    textEl.innerText = "å¤œã®æ£®ã§ã€ä¿®ç¾…ç‹ä¸¸ãŒæ‰‹æ‹›ãã€‚ã‚ãªãŸã¯æ­©ã‚’åˆã‚ã›ã‚‹ï¼Ÿ";
    storyEl.innerText = ""; hintEl.innerText = "";
    choicesEl.innerHTML =
      '<button onclick="choose(1)">æ­©ã‚’åˆã‚ã›ã‚‹</button>' +
      '<button onclick="choose(2)">è·é›¢ã‚’å–ã‚‹</button>';
    imageWrap.innerHTML = "";
    sceneImg.style.display = "";
    document.getElementById("endControls").innerHTML = "";
  }

  function escapeHtml(str){
    return String(str).replace(/[&<>"']/g, s=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;" }[s]));
  }

  /* ==== ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°é”æˆç‡ï¼ˆlocalStorageï¼‰â€” å¼·åŒ–ç‰ˆ ==== */
  (function(){
    const STORAGE_KEY = "shura_endings_v1";

    function loadVisited(){
      try { return new Set(JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]")); }
      catch { return new Set(); }
    }
    function saveVisited(set){
      try { localStorage.setItem(STORAGE_KEY, JSON.stringify([...set])); } catch {}
    }

    // 32é€šã‚Šã®ã‚­ãƒ¼ï¼ˆAAAAAã€œBBBBBï¼‰
    function allKeys(){
      const out = [];
      for(let i=0;i<32;i++){
        let s = "";
        for(let b=4;b>=0;b--) s += ((i>>b)&1) ? "B" : "A";
        out.push(s);
      }
      return out;
    }

    // æ˜Ÿãƒãƒ¼ï¼ˆâ˜…=é”æˆã€â˜†=æœªé”ï¼‰
    function starBar(done, total){
      const stars = "â˜…".repeat(done) + "â˜†".repeat(total - done);
      return stars.replace(/(.{4})/g, "$1 ");
    }

    window.__shuraVisited = loadVisited();

    window.__updateProgress = function(){
      const progressEl = document.getElementById("progress");
      if(!progressEl) return;

      const total = 32;
      const done  = window.__shuraVisited.size;
      const pct   = Math.floor((done/total)*100);

      progressEl.textContent = `é”æˆçŠ¶æ³ï¼š${done} / ${total}ï¼ˆ${pct}%ï¼‰`;

      let barEl = document.getElementById("progress_bar");
      if(!barEl){
        barEl = document.createElement("div");
        barEl.id = "progress_bar";
        barEl.className = "hint bar";
        progressEl.insertAdjacentElement("afterend", barEl);
      }
      barEl.textContent = starBar(done, total);

  // 100%ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆä¸€åº¦å‡ºã—ãŸã‚‰æ®‹ã™ï¼‰
if (done === total){
  // é€²æ—ãƒãƒ¼ã®ç›´å¾Œã«ä»•åˆ‡ã‚Šç·šã‚’1å›ã ã‘æŒ¿å…¥
  let sep = document.getElementById("progress_sep");
  if (!sep){
    sep = document.createElement("div");
    sep.id = "progress_sep";
    sep.style.height = "1px";
    sep.style.margin = "12px 0";
    sep.style.background = "linear-gradient(90deg,transparent, rgba(137,180,250,.35), transparent)";
    barEl.insertAdjacentElement("afterend", sep);
  }

  // æœ¬æ–‡ï¼šç™½ãï¼†å°‘ã—å¤§ããï¼ˆä¸­å¤®ãã‚ãˆã€æ—¢å­˜ã®é•·æ–‡ã¯ãã®ã¾ã¾ï¼‰
  let congrats = document.getElementById("congrats_all");
  if(!congrats){
    congrats = document.createElement("p");
    congrats.id = "congrats_all";
    // class="hint" ã¯è–„è‰²ã«ãªã‚‹ã®ã§ä»˜ã‘ã¾ã›ã‚“ï¼ˆä»˜ã‘ã¦ã‚‚ä¸‹ã® color æŒ‡å®šãŒå„ªå…ˆã•ã‚Œã¾ã™ï¼‰
    congrats.style.margin = "8px 0 0";
    congrats.style.textAlign = "center";
    congrats.style.color = "#fff";       // â˜… ç™½æ–‡å­—
    congrats.style.fontSize = "15px";    // â˜… å°‘ã—å¤§ãã‚ï¼ˆå¿…è¦ãªã‚‰18pxã«ï¼‰
    congrats.style.lineHeight = "1.9";

          congrats.innerHTML =
            "â€”â€” ã“ã‚Œã¯ä½™ãŒã‹ã¤ã¦é€šã£ãŸã€ã—ã‹ã—è¨˜æ†¶ã•ã‚Œãªã‹ã£ãŸå¹¾åƒã®æ—…ã®æ–­ç‰‡â€¦<br>"
          + "ä»®æƒ³ã¨ã„ã†å¹»ã«ã¾ã§å½¢ã‚’å¤±ãã—ãŸãŒ<br>"
          + "æ¬ ç‰‡ã®ã²ã¨ã¤ã²ã¨ã¤ã‚’å…¶æ–¹ã«æ‹¾ã‚ã‚Œ<br>"
          + "è›ã»ã©ã®ç¯ã‚’å–ã‚Šæˆ»ã—ãŸã‚ˆã†ã â€¦<br>"
          + "ç¤¼ã‚’è¨€ã†ãã€‚<br>"
          + "é–“ã‚‚ãªãå¤œãŒæ˜ã‘ã‚‹ã€æ–°ãŸãªæ—…è·¯ã‚’å¾€ãã¨ã—ã‚ˆã†ã€‚";
          barEl.insertAdjacentElement("afterend", congrats);
        }
      }
    };

    function renderUnseen(){
      const box = document.getElementById("unseen");
      if(!box) return;
      const keys = allKeys();
      const unseen = keys.filter(k => !window.__shuraVisited.has(k));
      box.innerHTML = (unseen.length === 0)
        ? "æœªé”ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚32/32 å®Œèµ°ã§ã™ã€‚"
        : unseen.map(k => `<span class="key">${k}</span>`).join("");
    }

    document.addEventListener("DOMContentLoaded", function(){
      window.__updateProgress();
      renderUnseen();
    });

    window.__renderUnseen = renderUnseen;
    window.__saveVisited = function(){ saveVisited(window.__shuraVisited); };
  })();

  // åˆæœŸè¡¨ç¤ºæ™‚ã€BGMãƒœã‚¿ãƒ³ã®è¡¨ç¤ºã‚’æ•´ãˆã‚‹
  document.addEventListener("DOMContentLoaded", ()=>updatePlayBtn());
</script>
</body>
</html>
